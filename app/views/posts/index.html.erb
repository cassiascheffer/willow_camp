<% content_for :title, "Posts" %>

<% content_for :head do %>
  <% if @author&.site_meta_description.present? %>
    <meta name="description" content="<%= @author.site_meta_description %>">
  <% end %>
<% end %>

<div class="container-standard">
  <% if notice.present? %>
    <p class="notice" id="notice"><%= notice %></p>
  <% end %>
  <% if alert.present? %>
    <p class="alert" id="alert"><%= alert %></p>
  <% end %>

  <div class="flex justify-between items-center mb-10">
    <h1 class="post-title">Posts</h1>
  </div>

  <div id="posts" class="space-y-8">
    <div class="calendar-navigation mb-6">
      <%== pagy_calendar_year_nav(@pagy) %>
    </div>
    
    <% if @posts_by_year.any? %>
      <div class="year-section">
        <h2 class="text-2xl font-bold mb-4"><%= @pagy.year.label %></h2>
        <div class="posts-list space-y-2">
          <% @posts_by_year.each do |post| %>
          <div class="post-card">
            <%= link_to post_path(post.slug), class: "post-card-link" do %>
              <h3 class="text-lg font-medium flex">
                <span class="text-date min-w-[4rem] shrink-0"><%= post.published_at.strftime("%b %d") %></span>
                <span class="pl-1">- <%= post.title %></span>
              </h3>
            <% end %>
          </div>
          <% end %>
        </div>
      </div>
    <% else %>
      <div class="empty-state">
        <p class="text-xl">No posts for <%= @pagy.year.label %></p>
        <p class="mt-2">Try selecting a different year</p>
      </div>
    <% end %>
  </div>
</div>
