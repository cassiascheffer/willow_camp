<!DOCTYPE html>
<html data-theme="<%= @author&.theme || "tokyo" %>" data-controller="favicon" data-favicon-emoji-value="<%= @author&.favicon_emoji || "â›º" %>">
  <head>
    <title>
      <%= content_for(:title) || blog_title_for(@author) %>
    </title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= yield :head %>
    <% if @author %>
      <%# RSS feed discovery link %>
      <%= auto_discovery_link_tag(:rss, posts_rss_url(format: :rss, subdomain: @author.subdomain), title: "#{blog_title_for(@author)} RSS Feed") %>
      <%# Atom feed discovery link %>
      <%= auto_discovery_link_tag(:atom, posts_atom_url(format: :atom, subdomain: @author.subdomain), title: "#{blog_title_for(@author)} Atom Feed") %>
      <%# JSON feed discovery link %>
      <link type="application/feed+json" rel="alternate" href="<%= posts_json_url(format: :json, subdomain: @author.subdomain) %>" title="<%= blog_title_for(@author) %> JSON Feed">
    <% end %>
    <!-- Favicon will be set dynamically by JS -->
  <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>
<body class="font-mono text-base bg-[var(--light-bg)] dark:bg-[var(--dark-bg)] text-[var(--light-text)] dark:text-[var(--dark-text)]">
  <% unless controller_name == 'home' && action_name == 'show' || controller_name == 'sessions' && action_name == 'new' %>
    <header class="border-b border-[var(--light-border)] dark:border-[var(--dark-border)] py-4 px-5">
      <div class="container mx-auto flex justify-between items-center">
        <a href="/" class="text-xl font-bold text-[var(--light-accent)] dark:text-[var(--dark-accent)]" aria-label="Home">
          <%= blog_title_for(@author) %>
        </a>
        <nav class="space-x-4">
          <% if @author.pages.present? %>
            <% @author.pages.each do |page| %>
              <a href="<%= post_path(page) %>" class="p-2 rounded hover:underline hover:decoration-2 hover:underline-offset-2" aria-label="<%= page.title %>">
                <%= page.title %>
              </a>
            <% end %>
          <% end %>
          <a href="<%= posts_rss_path(format: :rss) %>" class="p-2 rounded hover:underline hover:decoration-2 hover:underline-offset-2" title="RSS Feed" aria-label="RSS Feed">
            RSS
          </a>
        </nav>
      </div>
    </header>
  <% end %>
  <main class="max-w-3xl mx-auto px-4 py-8 sm:px-2 sm:py-8">
    <%= yield %>
  </main>
  <footer class="border-t border-[var(--light-border)] dark:border-[var(--dark-border)] py-4 px-5 mt-12">
    <% if @author.present? %>
      <div class="container mx-auto text-sm text-[var(--light-muted)] dark:text-[var(--dark-muted)]">
        Made with <%= link_to "willow.camp", root_url(subdomain: false, allow_other_subdomains: true) %>
      </div>
    <% end %>
  </footer>
</body>
</html>
